<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Minecraft</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="shortcut icon" href="img/imagenssobre/g9kvxxzd5nde1.png" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jersey+10&display=swap" rel="stylesheet">

  <!-- CSS espec√≠fico do jogo (apenas para a √°rea do jogo e ajuste da logo) -->
  <style>
    /* --- ajuste da logo conforme voc√™ pediu --- */
    .logo img{
      width: 100px;
      height: 100px;
      font-size: 2em;
      font-weight: bold;
    }

    /* === Estilos do jogo (aut√¥nomo, n√£o mexe no resto do site) === */
    #jogo {
      margin: 4vh auto;
      padding: 2.5vw;
      max-width: 1100px;
      width: 92%;
      background: #1f1f1f;
      border: 0.6vw solid #33b606;
      border-radius: 1.2vw;
      box-shadow: 0 0 1.6vw #33b60666;
      color: #e8ffdf;
      text-align: center;
      font-family: "Jersey 10", sans-serif;
    }

    #jogo h2 {
      margin: 0 0 0.5rem 0;
      color: #bfffb4;
      font-size: 1.6rem;
    }

    /* HUD */
    .hud {
      display:flex;
      justify-content: center;
      gap: 1rem;
      align-items: center;
      flex-wrap:wrap;
      margin-bottom: 1rem;
    }
    .hud .info {
      background: rgba(0,0,0,0.25);
      padding: .4rem .8rem;
      border-radius: .6rem;
      border: 1px solid rgba(255,255,255,0.04);
      color: #d8ffd7;
      font-weight: 600;
    }
    .hud button {
      background: linear-gradient(#2fb721,#1f9c0f);
      color: #061108;
      border: none;
      padding: .45rem .9rem;
      font-weight: 700;
      border-radius: .6rem;
      cursor: pointer;
      box-shadow: 0 0 .5rem #33b60666;
    }
    .hud button:hover { filter: brightness(1.06); }

    /* √Årea do jogo */
    .game-area {
      position: relative;
      margin: 0 auto;
      width: 100%;
      height: 40vh;
      min-height: 260px;
      max-height: 520px;
      background: #0b0b0b url("https://static.wikia.nocookie.net/minecraft_gamepedia/images/b/be/Overworld_background.png/revision/latest/scale-to-width-down/1000?cb=20210820070213");
      background-size: cover;
      border: 0.45vw solid #2d8f1f;
      border-radius: 0.8rem;
      overflow: hidden;
      box-sizing: border-box;
      display: block;
    }

    /* Castelos/forte na esquerda */
    #fort {
      position: absolute;
      left: 1.6%;
      top: 50%;
      transform: translateY(-50%);
      font-size: 3.2rem;
      pointer-events: none;
      filter: drop-shadow(0 0 .2rem #000);
      z-index: 5;
    }

    /* cada zumbi (USANDO left, n√£o right) */
    .zombie {
      position: absolute;
      left: 100%; /* inicia fora da √°rea, √† direita (JS sobrep√µe com px) */
      transform: translateY(-50%);
      top: 50%;
      font-size: 3.0rem;
      cursor: pointer;
      user-select: none;
      transition: transform .08s;
      will-change: left, transform;
      z-index: 6;
      text-shadow: 0 2px 0 rgba(0,0,0,0.6);
    }
    .zombie:active { transform: translateY(-50%) scale(.95); }

    /* anima√ß√£o r√°pida de "morrido" */
    .zombie.dead {
      transform: translateY(-50%) scale(0.6) rotate(-20deg);
      opacity: 0.0;
      transition: transform .25s, opacity .25s;
    }

    /* overlay Game Over dentro da √°rea do jogo */
    #gameOver {
      display: none;
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.78);
      z-index: 40;
      color: #ffcfcf;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
      text-align: center;
      border-radius: 0.8rem;
    }
    #gameOver h3 { margin: 0; color: #ff7b7b; font-size: 1.8rem; }
    #gameOver small { color: #ffdede; }

    #restartBtn {
      background: linear-gradient(#ff5b5b,#d02a2a);
      color: white;
      border: none;
      padding: .5rem 1rem;
      border-radius: .6rem;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 0 .6rem #ff6666aa;
    }
    #restartBtn:hover { transform: translateY(-2px); }

    /* indicador de pause (pequeno) */
    #pausedIndicator {
      position: absolute;
      left: 1.6%;
      top: 1.6%;
      z-index: 50;
      display: none;
      padding: .2rem .5rem;
      background: rgba(0,0,0,0.45);
      color: #ffd;
      border-radius: .4rem;
      font-weight: 700;
    }

    /* responsividade */
    @media (max-width: 520px) {
      #fort { font-size: 7.5vw; left: 3%; }
      .zombie { font-size: 7.5vw; }
      #jogo h2 { font-size: 1.1rem; }
      .hud .info { font-size: .9rem; }
      .hud button { padding: .4rem .7rem; }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="logo">
        <a href="index.html"><img src="img/imagenssobre/g9kvxxzd5nde1.png" alt="minecraft"></a>
      </div>
      <nav>
        <ul>
          <li><a href="index.html#inicio">Inicio</a></li>
          <li><a href="index.html#sobre">Sobre o Minecraft</a></li>
          <li><a href="index.html#oque">Oque os blocos fazem</a></li>
          <li><a href="index.html#galeria">Galeria de fotos</a></li>
          <li><a href="contato.html#contato">Contato</a></li>
          <li><a href="tabela.html">Tabela</a></li>
          <li><a href="jogo.html">Jogo</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section id="inicio" class="banner-jogo">
    <h1>Jogo tem√°tico de minecraft</h1>
    <p>Jogue um jogo novo ‚Äî defenda seu castelo dos zumbis!</p>
  </section>

  <!-- JOGO -->
  <main>
    <section id="jogo">
      <h2>üßü Defesa do Castelo</h2>

      <div class="hud">
        <div class="info">Pontos: <span id="score">0</span></div>
        <div class="info">Vidas: <span id="lives">3</span></div>
        <button id="pauseBtn">‚è∏ Pause</button>
      </div>

      <div class="game-area" id="gameArea" aria-live="polite">
        <div id="pausedIndicator">PAUSADO</div>

        <!-- o "forte" / castelo fica na esquerda -->
        <span id="fort" aria-hidden="true">üè∞</span>

        <!-- overlay de Game Over -->
        <div id="gameOver" role="dialog" aria-hidden="true">
          <h3>üíÄ Voc√™ perdeu!</h3>
          <small>Um zumbi alcan√ßou o castelo.</small>
          <div><button id="restartBtn">üîÑ Reiniciar</button></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>2025 - Site desenvolvido por Matheus Torres Betega</p>
  </footer>

  <!-- JS do jogo (revisado: usa left-based movement e colis√£o correta) -->
  <script>
  (function () {
    // elementos
    const gameArea = document.getElementById('gameArea');
    const scoreEl = document.getElementById('score');
    const livesEl = document.getElementById('lives');
    const pauseBtn = document.getElementById('pauseBtn');
    const pausedIndicator = document.getElementById('pausedIndicator');
    const gameOverEl = document.getElementById('gameOver');
    const restartBtn = document.getElementById('restartBtn');
    const fortEl = document.getElementById('fort');

    // estado
    let score = 0;
    let lives = 3;
    let paused = false;
    let running = false;
    let lastTime = 0;
    let zombies = []; // lista de {el, x, speed, width}
    let spawnTimer = null;

    // par√¢metros
    const BASE_CROSS_MS = 3800;
    const MIN_CROSS_MS = 850;
    const SPAWN_BASE = 1200;
    const SPAWN_MIN = 420;
    const SPAWN_DECREASE_PER_POINT = 15;

    function rand(min, max) { return Math.random() * (max - min) + min; }

    function startGame() {
      score = 0; lives = 3;
      scoreEl.textContent = score;
      livesEl.textContent = lives;
      clearAllZombies();
      hideGameOver();
      paused = false;
      pauseBtn.textContent = '‚è∏ Pause';
      pausedIndicator.style.display = 'none';
      scheduleSpawn();
      lastTime = performance.now();
      running = true;
      requestAnimationFrame(loop);
    }

    function computeCrossTime() {
      return Math.max(MIN_CROSS_MS, BASE_CROSS_MS - score * 60);
    }
    function computeSpawnInterval() {
      return Math.max(SPAWN_MIN, SPAWN_BASE - score * SPAWN_DECREASE_PER_POINT);
    }

    // cria zumbi (usando left)
    function spawnZombie() {
      if (!running || paused) return;
      const el = document.createElement('span');
      el.className = 'zombie';
      el.textContent = 'üßü';
      gameArea.appendChild(el);

      // posi√ß√£o vertical aleat√≥ria
      const areaH = gameArea.clientHeight;
      const yPercent = rand(0.28, 0.72);
      el.style.top = (yPercent * 100) + '%';

      // medir ap√≥s render
      const areaRect = gameArea.getBoundingClientRect();
      const elRect = el.getBoundingClientRect();
      const fortRect = fortEl.getBoundingClientRect();

      // dist√¢ncia a percorrer (em px)
      const distance = (elRect.left) - (fortRect.right);

      // velocidade px/ms para atravessar em crossTime
      const crossTime = computeCrossTime();
      const speed = (distance + elRect.width + 30) / crossTime; // px per ms

      // inicializa x relativo ao gameArea (em px, left)
      const initialX = areaRect.width + 30; // come√ßando fora da √°rea
      el.style.left = initialX + 'px';

      const zombieObj = { el, x: initialX, speed, width: elRect.width || 40 };
      zombies.push(zombieObj);

      // clique
      function onClickZombie(e) {
        if (paused || !running) return;
        el.classList.add('dead');
        el.removeEventListener('click', onClickZombie);
        setTimeout(() => removeZombie(zombieObj), 260);
        score++;
        scoreEl.textContent = score;
        rescheduleSpawn();
      }
      el.addEventListener('click', onClickZombie);
    }

    function removeZombie(z) {
      if (!z) return;
      try { if (z.el && z.el.parentNode) z.el.parentNode.removeChild(z.el); } catch(e) {}
      zombies = zombies.filter(item => item !== z);
    }

    function clearAllZombies() {
      zombies.forEach(z => { try{ if (z.el) z.el.remove(); }catch(e){} });
      zombies = [];
      if (spawnTimer) { clearInterval(spawnTimer); spawnTimer = null; }
    }

    function scheduleSpawn() {
      if (spawnTimer) clearInterval(spawnTimer);
      const interval = computeSpawnInterval();
      spawnTimer = setInterval(() => { spawnZombie(); }, interval);
    }
    function rescheduleSpawn() { scheduleSpawn(); }

    function loop(now) {
      if (!running) return;
      if (!lastTime) lastTime = now;
      const delta = now - lastTime;
      lastTime = now;

      if (!paused) {
        const areaRect = gameArea.getBoundingClientRect();
        const fortRect = fortEl.getBoundingClientRect();
        const fortRightRelative = fortEl.offsetLeft + fortEl.offsetWidth;

        // mover cada zumbi
        for (let i = zombies.length - 1; i >= 0; i--) {
          const z = zombies[i];
          z.x -= z.speed * delta; // update in px
          z.el.style.left = z.x + 'px';

          // recalcula bounding para seguran√ßa (visual)
          const zRect = z.el.getBoundingClientRect();
          // COLLISION (revisado): usa posi√ß√£o relativa (z.x is left in px inside gameArea)
          // verificamos quando a borda direita do zumbi (z.x + z.width) alcan√ßa a borda direita do fort (fort.offsetLeft + fort.offsetWidth)
          const zRightRelative = z.x + (z.width || z.el.offsetWidth);
          const fortRight = fortEl.offsetLeft + fortEl.offsetWidth;

          if (zRightRelative <= fortRight) {
            // zumbi realmente alcan√ßou o castelo -> perde vida
            try { z.el.remove(); } catch(e) {}
            zombies.splice(i,1);
            lives--;
            livesEl.textContent = lives;
            rescheduleSpawn();
            if (lives <= 0) { triggerGameOver(); return; }
          } else {
            // safety: se saiu totalmente da tela √† esquerda, remove
            if (zRect.right < -60) { try{ z.el.remove(); }catch(e){} zombies.splice(i,1); }
          }
        }
      }

      requestAnimationFrame(loop);
    }

    function triggerGameOver() {
      running = false;
      if (spawnTimer) { clearInterval(spawnTimer); spawnTimer = null; }
      gameOverEl.style.display = 'flex';
      gameOverEl.setAttribute('aria-hidden','false');
    }

    restartBtn.addEventListener('click', () => {
      gameOverEl.style.display = 'none';
      gameOverEl.setAttribute('aria-hidden','true');
      clearAllZombies();
      score = 0; lives = 3;
      scoreEl.textContent = score;
      livesEl.textContent = lives;
      paused = false;
      pauseBtn.textContent = '‚è∏ Pause';
      pausedIndicator.style.display = 'none';
      scheduleSpawn();
      running = true;
      lastTime = performance.now();
      requestAnimationFrame(loop);
    });

    pauseBtn.addEventListener('click', () => {
      paused = !paused;
      pauseBtn.textContent = paused ? '‚ñ∂ Resume' : '‚è∏ Pause';
      pausedIndicator.style.display = paused ? 'block' : 'none';
      if (paused) {
        if (spawnTimer) { clearInterval(spawnTimer); spawnTimer = null; }
      } else {
        scheduleSpawn();
      }
    });

    window.addEventListener('resize', () => { rescheduleSpawn(); });

    window.addEventListener('load', () => {
      score = 0; lives = 3;
      scoreEl.textContent = score;
      livesEl.textContent = lives;
      scheduleSpawn();
      running = true;
      lastTime = performance.now();
      requestAnimationFrame(loop);
    });

  })();
  </script>
</body>
</html>